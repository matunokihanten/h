<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>æ­£ç›´è€…ã‚’å½“ã¦ã‚‹ã‚²ãƒ¼ãƒ </title>
    <style>
        body {
            font-family: 'Helvetica Neue', Arial, sans-serif;
            max-width: 800px;
            margin: 0 auto;
            padding: 20px;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            color: #333;
        }

        .game-container {
            background: white;
            border-radius: 15px;
            padding: 30px;
            box-shadow: 0 15px 35px rgba(0,0,0,0.1);
            margin-bottom: 20px;
        }

        h1 {
            text-align: center;
            color: #4a5568;
            margin-bottom: 10px;
            font-size: 2.2em;
        }

        .subtitle {
            text-align: center;
            color: #718096;
            margin-bottom: 30px;
            font-size: 1.1em;
        }

        .scenario {
            background: #f7fafc;
            padding: 20px;
            border-radius: 10px;
            margin-bottom: 25px;
            border-left: 5px solid #4299e1;
        }

        .person {
            background: #fff;
            border: 2px solid #e2e8f0;
            border-radius: 10px;
            padding: 20px;
            margin-bottom: 15px;
            transition: all 0.3s ease;
            cursor: pointer;
            position: relative;
        }

        .person:hover {
            border-color: #4299e1;
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(66, 153, 225, 0.2);
        }

        .person.selected {
            border-color: #48bb78;
            background: #f0fff4;
        }

        .person-name {
            font-weight: bold;
            font-size: 1.2em;
            color: #2d3748;
            margin-bottom: 10px;
        }

        .person-statement {
            color: #4a5568;
            line-height: 1.6;
            font-style: italic;
        }

        .buttons {
            display: flex;
            gap: 15px;
            justify-content: center;
            margin-top: 30px;
        }

        button {
            background: linear-gradient(135deg, #4299e1, #3182ce);
            color: white;
            border: none;
            padding: 12px 25px;
            border-radius: 8px;
            cursor: pointer;
            font-size: 16px;
            font-weight: 600;
            transition: all 0.3s ease;
            box-shadow: 0 4px 12px rgba(66, 153, 225, 0.3);
        }

        button:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 20px rgba(66, 153, 225, 0.4);
        }

        button:disabled {
            background: #a0aec0;
            cursor: not-allowed;
            transform: none;
            box-shadow: none;
        }

        .result {
            margin-top: 25px;
            padding: 20px;
            border-radius: 10px;
            text-align: center;
            font-weight: bold;
            font-size: 1.1em;
        }

        .result.correct {
            background: #c6f6d5;
            color: #22543d;
            border: 2px solid #48bb78;
        }

        .result.incorrect {
            background: #fed7d7;
            color: #742a2a;
            border: 2px solid #e53e3e;
        }

        .explanation {
            background: #e6fffa;
            border: 2px solid #38b2ac;
            border-radius: 10px;
            padding: 20px;
            margin-top: 20px;
            line-height: 1.6;
        }

        .explanation h3 {
            color: #285e61;
            margin-top: 0;
            margin-bottom: 15px;
        }

        .explanation-button {
            background: linear-gradient(135deg, #38b2ac, #319795);
            margin-top: 15px;
        }

        .hidden {
            display: none;
        }

        .person-number {
            position: absolute;
            top: -10px;
            left: 15px;
            background: #4299e1;
            color: white;
            width: 25px;
            height: 25px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: bold;
            font-size: 14px;
        }
    </style>
</head>
<body>
    <div class="game-container">
        <h1>ğŸ•µï¸ æ­£ç›´è€…ã‚’å½“ã¦ã‚‹ã‚²ãƒ¼ãƒ </h1>
        <p class="subtitle">5äººã®ä¸­ã‹ã‚‰å”¯ä¸€ã®æ­£ç›´è€…ã‚’è¦‹ã¤ã‘å‡ºãã†ï¼</p>

        <div class="scenario">
            <h3>ğŸ¯ ã‚²ãƒ¼ãƒ ã®ãƒ«ãƒ¼ãƒ«</h3>
            <p>5äººã®æ—¥æœ¬äººãŒã„ã¾ã™ã€‚ã“ã®ä¸­ã§<strong>1äººã ã‘ãŒæ­£ç›´è€…</strong>ã§ã€æ®‹ã‚Šã®4äººã¯å˜˜ã¤ãã§ã™ã€‚</p>
            <p>æ­£ç›´è€…ã¯å¸¸ã«æœ¬å½“ã®ã“ã¨ã‚’è¨€ã„ã€å˜˜ã¤ãã¯å¸¸ã«å˜˜ã‚’ã¤ãã¾ã™ã€‚</p>
            <p>å„äººã®è¨¼è¨€ã‚’èª­ã‚“ã§ã€è«–ç†çš„ã«æ­£ç›´è€…ã‚’ç‰¹å®šã—ã¦ãã ã•ã„ã€‚</p>
        </div>

        <div id="gameArea">
            </div>

        <div class="buttons">
            <button onclick="submitAnswer()" id="submitBtn" disabled>ç­”ãˆã‚’ç¢ºå®šã™ã‚‹</button>
            <button onclick="resetGame()" id="resetBtn">æ–°ã—ã„å•é¡Œã¸ (ãƒªã‚»ãƒƒãƒˆ)</button>
        </div>

        <div id="result" class="hidden"></div>
        
        <div id="explanationSection" class="hidden">
            <button onclick="showExplanation()" class="explanation-button">ãªãœãã®äººãŒæ­£ç›´è€…ãªã®ã‹è§£èª¬ã‚’è¦‹ã‚‹</button>
            <div id="explanationContainer" class="hidden">
                </div>
        </div>
    </div>

    <script>
        const names = [
            ['ç”°ä¸­', 'ä½è—¤', 'éˆ´æœ¨', 'é«˜æ©‹', 'å±±ç”°'],
            ['æœ¨æ‘', 'æ¸¡è¾º', 'ä¼Šè—¤', 'å°æ—', 'ä¸­æ‘'],
            ['å‰ç”°', 'å±±å£', 'æ¾æœ¬', 'äº•ä¸Š', 'æ–è—¤'],
            ['å‰ç”°', 'è—¤ç”°', 'å²¡ç”°', 'é•·è°·å·', 'æ‘ä¸Š'],
            ['æ£®', 'æ—', 'æ¸…æ°´', 'å±±æœ¬', 'åŠ è—¤'],
            ['è°·å£', 'ç«¹å†…', 'è¥¿å·', 'çŸ³å·', 'æ©‹æœ¬'],
            ['å‚æœ¬', 'é è—¤', 'é’æœ¨', 'è—¤äº•', 'è¥¿ç”°'],
            ['ä¸‰æµ¦', 'æ± ç”°', 'åŸç”°', 'ä»Šäº•', 'ç¦ç”°'],
            ['çŸ³ç”°', 'ä¸Šç”°', 'æ£®ç”°', 'åŸ', 'å¹³é‡'],
            ['é‡æ‘', 'æ²³é‡', 'å®‰ç”°', 'å²¡æœ¬', 'æ¨ªå±±']
        ];

        let selectedPerson = null;
        let gameEnded = false;
        let currentProblem = null;
        let usedNameSets = [];

        // å•é¡Œãƒ‘ã‚¿ãƒ¼ãƒ³ã®ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆ
        const problemTemplates = [
            {
                // ãƒ‘ã‚¿ãƒ¼ãƒ³1: è‡ªå·±çŸ›ç›¾ã‚¿ã‚¤ãƒ—
                generator: (nameSet) => {
                    const truthTellerIndex = Math.floor(Math.random() * 5);
                    const people = [];
                    const statements = [
                        `ç§ã¯æ­£ç›´è€…ã§ã™ã€‚${nameSet[(truthTellerIndex + 1) % 5]}ã•ã‚“ã‚‚æ­£ç›´è€…ã§ã™ã€‚`,
                        `${nameSet[(truthTellerIndex + 2) % 5]}ã•ã‚“ã¯å˜˜ã¤ãã§ã™ã€‚ç§ãŒå”¯ä¸€ã®æ­£ç›´è€…ã§ã™ã€‚`,
                        `${nameSet[0]}ã•ã‚“ã¨${nameSet[1]}ã•ã‚“ã¯ä¸¡æ–¹ã¨ã‚‚å˜˜ã¤ãã§ã™ã€‚`,
                        `${nameSet[2]}ã•ã‚“ã¯å˜˜ã¤ãã§ã™ã€‚ç§ã¯æ­£ç›´è€…ã§ã™ã€‚`,
                        `${nameSet[3]}ã•ã‚“ã¯æ­£ç›´è€…ã§ã™ã€‚ç§ã¯å˜˜ã¤ãã§ã™ã€‚`
                    ];
                    
                    for (let i = 0; i < 5; i++) {
                        people.push({
                            name: nameSet[i] + 'ã•ã‚“',
                            statement: statements[i]
                        });
                    }
                    
                    return {
                        people,
                        correctAnswerIndex: 2,
                        explanationHTML: `
                            <h3>ğŸ“ è§£èª¬ (ç­”ãˆ: ${nameSet[2]}ã•ã‚“)</h3>
                            <p><strong>è«–ç†çš„ãªæ¨ç†éç¨‹ï¼š</strong></p>
                            <p>1. <strong>${nameSet[0]}ã•ã‚“ã®è¨¼è¨€ï¼š</strong><br>
                            ã€Œç§ã¯æ­£ç›´è€…ã§ã™ã€‚${nameSet[1]}ã•ã‚“ã‚‚æ­£ç›´è€…ã§ã™ã€‚ã€<br>
                            æ­£ç›´è€…ã¯1äººã ã‘ãªã®ã§ã€ã“ã®è¨¼è¨€ã¯çŸ›ç›¾ã—ã¦ã„ã¾ã™ã€‚ã—ãŸãŒã£ã¦ã€<strong>${nameSet[0]}ã•ã‚“ã¯å˜˜ã¤ã</strong>ã§ã™ã€‚</p>
                            <p>2. <strong>${nameSet[2]}ã•ã‚“ã®è¨¼è¨€ï¼š</strong><br>
                            ã€Œ${nameSet[0]}ã•ã‚“ã¨${nameSet[1]}ã•ã‚“ã¯ä¸¡æ–¹ã¨ã‚‚å˜˜ã¤ãã§ã™ã€‚ã€<br>
                            ${nameSet[0]}ã•ã‚“ãŒå˜˜ã¤ãã§ã‚ã‚‹ã“ã¨ã¯ç¢ºå®šã—ã¾ã—ãŸã€‚${nameSet[2]}ã•ã‚“ãŒæ­£ç›´è€…ã ã¨ä»®å®šã™ã‚‹ã¨ã€${nameSet[1]}ã•ã‚“ã‚‚å˜˜ã¤ãã¨ã„ã†ã“ã¨ã«ãªã‚Šã¾ã™ã€‚</p>
                            <p>3. <strong>æ¤œè¨¼ï¼š</strong><br>
                            ${nameSet[2]}ã•ã‚“ãŒæ­£ç›´è€…ã§ã€ä»–ãŒå…¨å“¡å˜˜ã¤ãã ã¨ä»®å®šã—ã¦ç¢ºèªã—ã¾ã™ã€‚<br>
                            - ${nameSet[1]}ã•ã‚“ï¼ˆå˜˜ã¤ãï¼‰ã®è¨¼è¨€ã¯ã€Œ${nameSet[3]}ã•ã‚“ã¯å˜˜ã¤ãã§ã™ã€‚ç§ãŒå”¯ä¸€ã®æ­£ç›´è€…ã§ã™ã€‚ã€å‰åŠã¯æ­£ã—ã„ã§ã™ãŒã€å¾ŒåŠãŒå˜˜ãªã®ã§å…¨ä½“ã¨ã—ã¦å˜˜ã®è¨¼è¨€ã¨ãªã‚Šã¾ã™ã€‚<br>
                            - ${nameSet[3]}ã•ã‚“ï¼ˆå˜˜ã¤ãï¼‰ã®è¨¼è¨€ã€Œ${nameSet[2]}ã•ã‚“ã¯å˜˜ã¤ãã§ã™ã€ã¯å˜˜ã«ãªã‚Šã€ä¸€è‡´ã—ã¾ã™ã€‚<br>
                            - ${nameSet[4]}ã•ã‚“ï¼ˆå˜˜ã¤ãï¼‰ã®è¨¼è¨€ã€Œ${nameSet[3]}ã•ã‚“ã¯æ­£ç›´è€…ã§ã™ã€ã¯å˜˜ã«ãªã‚Šã€ä¸€è‡´ã—ã¾ã™ã€‚</p>
                            <p><strong>çµè«–ï¼š</strong> ${nameSet[2]}ã•ã‚“ãŒå”¯ä¸€ã®æ­£ç›´è€…ã§ã™ã€‚</p>
                        `
                    };
                }
            },
            {
                // ãƒ‘ã‚¿ãƒ¼ãƒ³2: ãƒ‘ãƒ©ãƒ‰ãƒƒã‚¯ã‚¹ã‚¿ã‚¤ãƒ—
                generator: (nameSet) => {
                    const people = [
                        { name: nameSet[0] + 'ã•ã‚“', statement: "ç§ã¯å˜˜ã¤ãã§ã™ã€‚" },
                        { name: nameSet[1] + 'ã•ã‚“', statement: `${nameSet[0]}ã•ã‚“ã¯å˜˜ã¤ãã§ã™ã€‚` },
                        { name: nameSet[2] + 'ã•ã‚“', statement: `${nameSet[3]}ã•ã‚“ã¯æ­£ç›´è€…ã§ã™ã€‚` },
                        { name: nameSet[3] + 'ã•ã‚“', statement: `${nameSet[4]}ã•ã‚“ã¯å˜˜ã¤ãã§ã™ã€‚` },
                        { name: nameSet[4] + 'ã•ã‚“', statement: "ç§ã¯æ­£ç›´è€…ã§ã™ã€‚" }
                    ];
                    
                    return {
                        people,
                        correctAnswerIndex: 1,
                        explanationHTML: `
                            <h3>ğŸ“ è§£èª¬ (ç­”ãˆ: ${nameSet[1]}ã•ã‚“)</h3>
                            <p><strong>è«–ç†çš„ãªæ¨ç†éç¨‹ï¼š</strong></p>
                            <p>1. <strong>${nameSet[0]}ã•ã‚“ã®è¨¼è¨€ï¼š</strong><br>
                            ã€Œç§ã¯å˜˜ã¤ãã§ã™ã€‚ã€<br>
                            ã“ã‚Œã¯ã€Œå˜˜ã¤ãã®ãƒ‘ãƒ©ãƒ‰ãƒƒã‚¯ã‚¹ã€ã§ã™ã€‚æ­£ç›´è€…ã¯å˜˜ã‚’ã¤ã‘ãšã€å˜˜ã¤ãã¯çœŸå®Ÿã‚’è¨€ãˆãªã„ã®ã§ã€ã“ã®ç™ºè¨€è€…ã¯å˜˜ã¤ãã¨åˆ¤æ–­ã—ã¾ã™ã€‚</p>
                            <p>2. <strong>${nameSet[1]}ã•ã‚“ã®è¨¼è¨€ï¼š</strong><br>
                            ã€Œ${nameSet[0]}ã•ã‚“ã¯å˜˜ã¤ãã§ã™ã€‚ã€<br>
                            ã‚¹ãƒ†ãƒƒãƒ—1ã§${nameSet[0]}ã•ã‚“ã¯å˜˜ã¤ãã ã¨ç¢ºå®šã—ãŸã®ã§ã€ã“ã®ç™ºè¨€ã¯çœŸå®Ÿã§ã™ã€‚ã—ãŸãŒã£ã¦ã€<strong>${nameSet[1]}ã•ã‚“ãŒæ­£ç›´è€…</strong>ã§ã™ã€‚</p>
                            <p>3. <strong>æ¤œè¨¼ï¼š</strong><br>
                            ${nameSet[1]}ã•ã‚“ãŒæ­£ç›´è€…ã§ã€ä»–ãŒå˜˜ã¤ãã ã¨ä»®å®šï¼š<br>
                            - ${nameSet[4]}ã•ã‚“ï¼ˆå˜˜ã¤ãï¼‰ï¼šã€Œç§ã¯æ­£ç›´è€…ã§ã™ã€â†’å˜˜ã€‚OKã€‚<br>
                            - ${nameSet[3]}ã•ã‚“ï¼ˆå˜˜ã¤ãï¼‰ï¼šã€Œ${nameSet[4]}ã•ã‚“ã¯å˜˜ã¤ãã§ã™ã€â†’çœŸå®Ÿã‚’è¨€ã£ã¦ã—ã¾ã£ã¦ã„ã‚‹ãŒã€å˜˜ã¤ãã§ã‚‚çµæœçš„ã«çœŸå®Ÿã«ãªã‚‹ã“ã¨ã¯ã‚ã‚Šã¾ã™ã€‚<br>
                            - ${nameSet[2]}ã•ã‚“ï¼ˆå˜˜ã¤ãï¼‰ï¼šã€Œ${nameSet[3]}ã•ã‚“ã¯æ­£ç›´è€…ã§ã™ã€â†’å˜˜ã€‚OKã€‚</p>
                            <p><strong>çµè«–ï¼š</strong> ${nameSet[1]}ã•ã‚“ãŒå”¯ä¸€ã®æ­£ç›´è€…ã§ã™ã€‚</p>
                        `
                    };
                }
            },
            {
                // ãƒ‘ã‚¿ãƒ¼ãƒ³3: ç›¸äº’çŸ›ç›¾ã‚¿ã‚¤ãƒ—
                generator: (nameSet) => {
                    const people = [
                        { name: nameSet[0] + 'ã•ã‚“', statement: `${nameSet[1]}ã•ã‚“ã¯å˜˜ã¤ãã§ã™ã€‚` },
                        { name: nameSet[1] + 'ã•ã‚“', statement: `${nameSet[2]}ã•ã‚“ã¯æ­£ç›´è€…ã§ã™ã€‚` },
                        { name: nameSet[2] + 'ã•ã‚“', statement: `${nameSet[1]}ã•ã‚“ã¯å˜˜ã¤ãã§ã™ã€‚` },
                        { name: nameSet[3] + 'ã•ã‚“', statement: `${nameSet[4]}ã•ã‚“ã¨ç§ã®ä¸­ã§æ­£ç›´è€…ã¯1äººã„ã¾ã™ã€‚` },
                        { name: nameSet[4] + 'ã•ã‚“', statement: `${nameSet[3]}ã•ã‚“ã¯å˜˜ã¤ãã§ã™ã€‚ç§ã‚‚å˜˜ã¤ãã§ã™ã€‚` }
                    ];
                    
                    return {
                        people,
                        correctAnswerIndex: 2,
                        explanationHTML: `
                            <h3>ğŸ“ è§£èª¬ (ç­”ãˆ: ${nameSet[2]}ã•ã‚“)</h3>
                            <p><strong>è«–ç†çš„ãªæ¨ç†éç¨‹ï¼š</strong></p>
                            <p>1. <strong>${nameSet[1]}ã•ã‚“ã¨${nameSet[2]}ã•ã‚“ã®è¨¼è¨€ï¼š</strong><br>
                            ${nameSet[1]}ã•ã‚“ï¼šã€Œ${nameSet[2]}ã•ã‚“ã¯æ­£ç›´è€…ã§ã™ã€<br>
                            ${nameSet[2]}ã•ã‚“ï¼šã€Œ${nameSet[1]}ã•ã‚“ã¯å˜˜ã¤ãã§ã™ã€<br>
                            ã‚‚ã—${nameSet[1]}ã•ã‚“ãŒæ­£ç›´è€…ãªã‚‰ã€${nameSet[2]}ã•ã‚“ã‚‚æ­£ç›´è€…ã¨ãªã‚Šãƒ«ãƒ¼ãƒ«é•åã§ã™ã€‚ã‚ˆã£ã¦${nameSet[1]}ã•ã‚“ã¯å˜˜ã¤ãã§ã™ã€‚</p>
                            <p>2. <strong>${nameSet[2]}ã•ã‚“ã®è¨¼è¨€æ¤œè¨¼ï¼š</strong><br>
                            ${nameSet[2]}ã•ã‚“ã®ã€Œ${nameSet[1]}ã•ã‚“ã¯å˜˜ã¤ãã§ã™ã€ã¯çœŸå®Ÿã§ã™ï¼ˆã‚¹ãƒ†ãƒƒãƒ—1ã‚ˆã‚Šï¼‰ã€‚çœŸå®Ÿã‚’è¨€ãˆã‚‹ã®ã¯æ­£ç›´è€…ã ã‘ãªã®ã§ã€${nameSet[2]}ã•ã‚“ãŒæ­£ç›´è€…ã§ã™ã€‚</p>
                            <p>3. <strong>${nameSet[4]}ã•ã‚“ã®è¨¼è¨€ï¼š</strong><br>
                            ã€Œ${nameSet[3]}ã•ã‚“ã¯å˜˜ã¤ãã§ã™ã€‚ç§ã‚‚å˜˜ã¤ãã§ã™ã€‚ã€<br>
                            å¾ŒåŠéƒ¨åˆ†ãŒçœŸå®Ÿãªã‚‰æ­£ç›´è€…ã«ãªã£ã¦ã—ã¾ã†ãŸã‚çŸ›ç›¾ã§ã™ã€‚å˜˜ã¤ããŒã“ã®ã‚ˆã†ãªè‡ªå·±è¨€åŠã‚’ã—ãŸå ´åˆã€å˜˜ã¤ãã¨ã—ã¦æ‰±ã„ã¾ã™ã€‚</p>
                            <p>4. <strong>æ¤œè¨¼ï¼š</strong><br>
                            ${nameSet[2]}ã•ã‚“ãŒæ­£ç›´è€…ã§ã€ä»–ãŒå˜˜ã¤ãã ã¨ä»®å®šã™ã‚‹ã¨ã€å…¨ã¦ã®è¨¼è¨€ã«çŸ›ç›¾ãŒç”Ÿã˜ã¾ã›ã‚“ã€‚</p>
                            <p><strong>çµè«–ï¼š</strong> ${nameSet[2]}ã•ã‚“ãŒå”¯ä¸€ã®æ­£ç›´è€…ã§ã™ã€‚</p>
                        `
                    };
                }
            },
            {
                // ãƒ‘ã‚¿ãƒ¼ãƒ³4: è¤‡æ•°äººè¨€åŠã‚¿ã‚¤ãƒ—
                generator: (nameSet) => {
                    const people = [
                        { name: nameSet[0] + 'ã•ã‚“', statement: `ã“ã®ä¸­ã«æ­£ç›´è€…ã¯2äººã„ã¾ã™ã€‚` },
                        { name: nameSet[1] + 'ã•ã‚“', statement: `${nameSet[0]}ã•ã‚“ã¯å˜˜ã¤ãã§ã™ã€‚${nameSet[2]}ã•ã‚“ã‚‚å˜˜ã¤ãã§ã™ã€‚` },
                        { name: nameSet[2] + 'ã•ã‚“', statement: `ç§ã¯å˜˜ã¤ãã§ã™ã€‚ã§ã‚‚${nameSet[3]}ã•ã‚“ã¯æ­£ç›´è€…ã§ã™ã€‚` },
                        { name: nameSet[3] + 'ã•ã‚“', statement: `${nameSet[2]}ã•ã‚“ã¯å˜˜ã¤ãã§ã™ã€‚` },
                        { name: nameSet[4] + 'ã•ã‚“', statement: `${nameSet[1]}ã•ã‚“ã¯å˜˜ã¤ãã§ã™ã€‚` }
                    ];
                    
                    return {
                        people,
                        correctAnswerIndex: 3,
                        explanationHTML: `
                            <h3>ğŸ“ è§£èª¬ (ç­”ãˆ: ${nameSet[3]}ã•ã‚“)</h3>
                            <p><strong>è«–ç†çš„ãªæ¨ç†éç¨‹ï¼š</strong></p>
                            <p>1. <strong>${nameSet[0]}ã•ã‚“ã®è¨¼è¨€ï¼š</strong><br>
                            ã€Œã“ã®ä¸­ã«æ­£ç›´è€…ã¯2äººã„ã¾ã™ã€‚ã€<br>
                            æ­£ç›´è€…ã¯1äººã ã‘ã¨ã„ã†ãƒ«ãƒ¼ãƒ«ã«åã™ã‚‹ã®ã§ã€ã“ã®è¨¼è¨€ã¯å˜˜ã§ã™ã€‚ã‚ˆã£ã¦${nameSet[0]}ã•ã‚“ã¯å˜˜ã¤ãã§ã™ã€‚</p>
                            <p>2. <strong>${nameSet[2]}ã•ã‚“ã®è¨¼è¨€ï¼š</strong><br>
                            ã€Œç§ã¯å˜˜ã¤ãã§ã™ã€‚ã§ã‚‚${nameSet[3]}ã•ã‚“ã¯æ­£ç›´è€…ã§ã™ã€‚ã€<br>
                            å‰åŠãŒçœŸå®Ÿãªã‚‰æ­£ç›´è€…ã«ãªã‚ŠçŸ›ç›¾ã€‚å˜˜ã¤ããŒã“ã®ç™ºè¨€ã‚’ã™ã‚‹ãƒ‘ãƒ©ãƒ‰ãƒƒã‚¯ã‚¹ã¨ã—ã¦ã€${nameSet[2]}ã•ã‚“ã¯å˜˜ã¤ãã¨åˆ¤æ–­ã—ã¾ã™ã€‚</p>
                            <p>3. <strong>${nameSet[3]}ã•ã‚“ã®è¨¼è¨€ï¼š</strong><br>
                            ã€Œ${nameSet[2]}ã•ã‚“ã¯å˜˜ã¤ãã§ã™ã€‚ã€<br>
                            ã‚¹ãƒ†ãƒƒãƒ—2ã§${nameSet[2]}ã•ã‚“ã¯å˜˜ã¤ãã¨åˆ¤æ˜ã—ãŸã®ã§ã€ã“ã®ç™ºè¨€ã¯çœŸå®Ÿã§ã™ã€‚ã‚ˆã£ã¦${nameSet[3]}ã•ã‚“ãŒæ­£ç›´è€…ã§ã™ã€‚</p>
                            <p>4. <strong>æ¤œè¨¼ï¼š</strong><br>
                            ${nameSet[3]}ã•ã‚“ãŒæ­£ç›´è€…ã§ã€ä»–ãŒå˜˜ã¤ãã ã¨ä»®å®šï¼š<br>
                            - ${nameSet[1]}ã•ã‚“ï¼ˆå˜˜ã¤ãï¼‰ï¼šã€Œ${nameSet[0]}ã•ã‚“ã¯å˜˜ã¤ãã€${nameSet[2]}ã•ã‚“ã‚‚å˜˜ã¤ãã€â†’ä¸¡æ–¹ã¨ã‚‚çœŸå®Ÿã§ã™ãŒã€å˜˜ã¤ãã§ã‚‚çµæœçš„ã«çœŸå®Ÿã‚’è¨€ã†ã“ã¨ã¯ã‚ã‚Šã¾ã™ã€‚<br>
                            - ${nameSet[4]}ã•ã‚“ï¼ˆå˜˜ã¤ãï¼‰ï¼šã€Œ${nameSet[1]}ã•ã‚“ã¯å˜˜ã¤ãã§ã™ã€â†’çœŸå®Ÿã§ã™ãŒã€åŒä¸Šã®ç†ç”±ã§å•é¡Œã‚ã‚Šã¾ã›ã‚“ã€‚</p>
                            <p><strong>çµè«–ï¼š</strong> ${nameSet[3]}ã•ã‚“ãŒå”¯ä¸€ã®æ­£ç›´è€…ã§ã™ã€‚</p>
                        `
                    };
                }
            },
            {
                // ãƒ‘ã‚¿ãƒ¼ãƒ³5: é€£é–æ¨è«–ã‚¿ã‚¤ãƒ—
                generator: (nameSet) => {
                    const people = [
                        { name: nameSet[0] + 'ã•ã‚“', statement: `${nameSet[1]}ã•ã‚“ãŒæ­£ç›´è€…ãªã‚‰ã€${nameSet[2]}ã•ã‚“ã¯å˜˜ã¤ãã§ã™ã€‚` },
                        { name: nameSet[1] + 'ã•ã‚“', statement: `ç§ã¯æ­£ç›´è€…ã§ã¯ã‚ã‚Šã¾ã›ã‚“ã€‚` },
                        { name: nameSet[2] + 'ã•ã‚“', statement: `${nameSet[3]}ã•ã‚“ã¨${nameSet[4]}ã•ã‚“ã®ã©ã¡ã‚‰ã‹ãŒæ­£ç›´è€…ã§ã™ã€‚` },
                        { name: nameSet[3] + 'ã•ã‚“', statement: `${nameSet[4]}ã•ã‚“ã¯å˜˜ã¤ãã§ã™ã€‚` },
                        { name: nameSet[4] + 'ã•ã‚“', statement: `${nameSet[3]}ã•ã‚“ã¯å˜˜ã¤ãã§ã™ã€‚` }
                    ];
                    
                    return {
                        people,
                        correctAnswerIndex: 3,
                        explanationHTML: `
                            <h3>ğŸ“ è§£èª¬ (ç­”ãˆ: ${nameSet[3]}ã•ã‚“)</h3>
                            <p><strong>è«–ç†çš„ãªæ¨ç†éç¨‹ï¼š</strong></p>
                            <p>1. <strong>${nameSet[1]}ã•ã‚“ã®è¨¼è¨€ï¼š</strong><br>
                            ã€Œç§ã¯æ­£ç›´è€…ã§ã¯ã‚ã‚Šã¾ã›ã‚“ã€‚ã€<br>
                            ã“ã‚Œã¯è‡ªå·±å¦å®šã®ãƒ‘ãƒ©ãƒ‰ãƒƒã‚¯ã‚¹ã§ã™ã€‚æ­£ç›´è€…ã¯ã“ã®ç™ºè¨€ã‚’ã§ããšã€å˜˜ã¤ãã‚‚çœŸå®Ÿã‚’è¨€ãˆãªã„ã®ã§ã“ã®ç™ºè¨€ã¯ã§ãã¾ã›ã‚“ã€‚ã—ã‹ã—ã€ã“ã®ã‚ˆã†ãªç™ºè¨€è€…ã¯å˜˜ã¤ãã¨åˆ¤æ–­ã—ã¾ã™ã€‚</p>
                            <p>2. <strong>${nameSet[3]}ã•ã‚“ã¨${nameSet[4]}ã•ã‚“ã®è¨¼è¨€ï¼š</strong><br>
                            ${nameSet[3]}ã•ã‚“ï¼šã€Œ${nameSet[4]}ã•ã‚“ã¯å˜˜ã¤ãã§ã™ã€<br>
                            ${nameSet[4]}ã•ã‚“ï¼šã€Œ${nameSet[3]}ã•ã‚“ã¯å˜˜ã¤ãã§ã™ã€<br>
                            ã“ã®2äººã¯äº’ã„ã‚’å˜˜ã¤ãã¨è¨€ã£ã¦ã„ã¾ã™ã€‚ä¸¡æ–¹ã¨ã‚‚æ­£ç›´è€…ã§ã‚ã‚‹ã“ã¨ã¯ã§ãã¾ã›ã‚“ã€‚ã©ã¡ã‚‰ã‹ä¸€æ–¹ãŒæ­£ç›´è€…ã§ã™ã€‚</p>
                            <p>3. <strong>${nameSet[2]}ã•ã‚“ã®è¨¼è¨€ï¼š</strong><br>
                            ã€Œ${nameSet[3]}ã•ã‚“ã¨${nameSet[4]}ã•ã‚“ã®ã©ã¡ã‚‰ã‹ãŒæ­£ç›´è€…ã§ã™ã€‚ã€<br>
                            ã“ã‚Œã¯è«–ç†çš„ã«æ­£ã—ã„è¦³å¯Ÿã§ã™ã€‚ã—ã‹ã—ã€ã‚‚ã—${nameSet[2]}ã•ã‚“ãŒæ­£ç›´è€…ãªã‚‰ã€${nameSet[3]}ã•ã‚“ã¨${nameSet[4]}ã•ã‚“ã¯ä¸¡æ–¹ã¨ã‚‚å˜˜ã¤ãã«ãªã‚Šã€è¨¼è¨€ã¨çŸ›ç›¾ã—ã¾ã™ã€‚ã‚ˆã£ã¦${nameSet[2]}ã•ã‚“ã¯å˜˜ã¤ãã§ã™ã€‚</p>
                            <p>4. <strong>çµè«–ï¼š</strong><br>
                            ${nameSet[3]}ã•ã‚“ã¨${nameSet[4]}ã•ã‚“ã®ã†ã¡ã€ã©ã¡ã‚‰ã‹ãŒæ­£ç›´è€…ã§ã™ã€‚æ¶ˆå»æ³•ã§${nameSet[3]}ã•ã‚“ãŒæ­£ç›´è€…ã¨ä»®å®šã™ã‚‹ã¨ã€å…¨ã¦ã®è¨¼è¨€ã«çŸ›ç›¾ãŒç”Ÿã˜ã¾ã›ã‚“ã€‚</p>
                            <p><strong>çµè«–ï¼š</strong> ${nameSet[3]}ã•ã‚“ãŒå”¯ä¸€ã®æ­£ç›´è€…ã§ã™ã€‚</p>
                        `
                    };
                }
            }
        ];

        function generateProblem() {
            // ä½¿ç”¨æ¸ˆã¿ã§ãªã„åå‰ã‚»ãƒƒãƒˆã‚’é¸æŠ
            let availableNameSets = [];
            for (let i = 0; i < names.length; i++) {
                if (!usedNameSets.includes(i)) {
                    availableNameSets.push(i);
                }
            }
            
            // å…¨ã¦ä½¿ç”¨æ¸ˆã¿ãªã‚‰ãƒªã‚»ãƒƒãƒˆ
            if (availableNameSets.length === 0) {
                usedNameSets = [];
                availableNameSets = Array.from({length: names.length}, (_, i) => i);
            }
            
            const nameSetIndex = availableNameSets[Math.floor(Math.random() * availableNameSets.length)];
            usedNameSets.push(nameSetIndex);
            
            const selectedNameSet = names[nameSetIndex];
            const template = problemTemplates[Math.floor(Math.random() * problemTemplates.length)];
            
            return template.generator(selectedNameSet);
        }

        function loadProblem() {
            currentProblem = generateProblem();
            const gameArea = document.getElementById('gameArea');
            const explanationContainer = document.getElementById('explanationContainer');
            
            // ã‚²ãƒ¼ãƒ ã‚¨ãƒªã‚¢ã‚’ã‚¯ãƒªã‚¢
            gameArea.innerHTML = '';

            // äººç‰©ã¨è¨¼è¨€ã‚’ç”Ÿæˆ
            currentProblem.people.forEach((person, i) => {
                const personDiv = document.createElement('div');
                personDiv.className = 'person';
                personDiv.setAttribute('onclick', `selectPerson(${i + 1})`);
                
                personDiv.innerHTML = `
                    <div class="person-number">${i + 1}</div>
                    <div class="person-name">${person.name}</div>
                    <div class="person-statement">ã€Œ${person.statement}ã€</div>
                `;
                gameArea.appendChild(personDiv);
            });
            
            // è§£èª¬ã‚’ã‚»ãƒƒãƒˆ
            explanationContainer.innerHTML = currentProblem.explanationHTML;
        }

        function selectPerson(personNumber) {
            if (gameEnded) return;
            
            document.querySelectorAll('.person').forEach(p => p.classList.remove('selected'));
            
            selectedPerson = personNumber;
            document.querySelectorAll('.person')[personNumber - 1].classList.add('selected');
            
            document.getElementById('submitBtn').disabled = false;
        }

        function submitAnswer() {
            if (selectedPerson === null || gameEnded) return;
            
            gameEnded = true;
            const resultDiv = document.getElementById('result');
            const explanationSection = document.getElementById('explanationSection');
            const correctAnswer = currentProblem.correctAnswerIndex + 1;
            const correctAnswerName = currentProblem.people[currentProblem.correctAnswerIndex].name;

            resultDiv.classList.remove('hidden');
            
            if (selectedPerson === correctAnswer) {
                resultDiv.className = 'result correct';
                resultDiv.innerHTML = `ğŸ‰ æ­£è§£ã§ã™ï¼<br>${correctAnswerName}ãŒæ­£ç›´è€…ã§ã—ãŸã€‚`;
            } else {
                const selectedName = currentProblem.people[selectedPerson - 1].name;
                resultDiv.className = 'result incorrect';
                resultDiv.innerHTML = `âŒ æ®‹å¿µï¼<br>${selectedName}ã§ã¯ã‚ã‚Šã¾ã›ã‚“ã€‚<br>æ­£è§£ã¯${correctAnswerName}ã§ã—ãŸã€‚`;
            }
            
            explanationSection.classList.remove('hidden');
            document.getElementById('submitBtn').disabled = true;
        }

        function showExplanation() {
            document.getElementById('explanationContainer').classList.remove('hidden');
        }

        function resetGame() {
            // ã‚²ãƒ¼ãƒ çŠ¶æ…‹ã‚’ãƒªã‚»ãƒƒãƒˆ
            selectedPerson = null;
            gameEnded = false;
            
            // æ–°ã—ã„å•é¡Œã‚’ãƒ­ãƒ¼ãƒ‰
            loadProblem();
            
            // çµæœã¨è§£èª¬ã‚’éš ã™
            document.getElementById('result').classList.add('hidden');
            document.getElementById('explanationSection').classList.add('hidden');
            document.getElementById('explanationContainer').classList.add('hidden');
            
            // ãƒœã‚¿ãƒ³ã®çŠ¶æ…‹ã‚’ãƒªã‚»ãƒƒãƒˆ
            document.getElementById('submitBtn').disabled = true;
        }

        // åˆæœŸãƒ­ãƒ¼ãƒ‰
        window.onload = () => {
            loadProblem();
        };
    </script>
</body>
</html>